<!--update.ejs-->

<form action="/coupon/update/<%= coupon.id %>" method="post">

    <div class="field">
        <label class="label">Title</label>
        <div class="control">
            <input class="input" type="text" name="title" value="<%= coupon.title%>" required>
        </div>
    </div>

    <div class="field">
        <label class="label">Restaurant</label>
        <div class="control">
            <input class="input" type="text" name="restaurant" value="<%= coupon.restaurant%>" required>
        </div>
    </div>

    <div class="field">
        <label class="label">Region</label>
        <div class="control">

            <div class="select">

                <select onchange="regionSelected(this.value)" name="region" class="hehe">
                    <option id="non" vaule="">Select the region</option>
                    <option id="KWL" vaule="KWL">Kowloon </option>
                    <option id="HKI" value="HKI">HK Island</option>
                    <option id="NT" value="NT">New Territories</option>
                </select>
            </div>
        </div>
    </div>

    <div class="field">
        <label class="label">Mall</label>
        <div class="control">
            <div class="select">
                <select id="mall" name="mall" disabled>
                </select>
            </div>
        </div>
    </div>


    <div class="field">
        <label class="label">Image</label>
        <div class="control">
            <input class="input" type="text" name="image" value="<%= coupon.image%>" required>
        </div>
    </div>



    <div class="field">
        <label class="label">Quota</label>
        <div class="control">
            <input class="input" type="number" name="quota" value="<%= coupon.quota%>" required>
        </div>
    </div>

    <div class="field">
        <label class="label">Coin</label>
        <div class="control">
            <input class="input" type="number" name="coin" value="<%= coupon.coin%>" required>
        </div>
    </div>

    <div class="field">
        <label class="label">Expire Date</label>
        <div class="control">
            <input class="input" type="text" name="expireDate" value="<%= coupon.expireDate%>" required>
        </div>
    </div>


    <div class="field">
        <label class="label">Detail</label>
        <div class="control">
            <textarea class="textarea" placeholder="Textarea" name="detail"><%= coupon.detail%></textarea>
        </div>
    </div>


    <div class="field">
        <div class="control">
            <button class="button is-link" type="submit">Submit</button>
        </div>
    </div>
</form>

<!--
<br>
<br>-->


<form action="/coupon/delete/<%= coupon.id %>" method="post" >

    <div class="field">
        <div class="control" style="float: right;">
            <button class="button is-link" type="submit">Delete</button>
        </div>
    </div>

</form>




<script>
    var hkI = ["IFC Mall", "Pacific Place", "Time Square", "Element"];
    var kwl = ["Harbour City", "Festival Walk", "Megabox", "APM"];
    var nt = ["New Town Plaza", "Tsuen Wan Plaza"];

    function regionSelected(region) {


        var mallElem = document.getElementById("mall");
        mallElem.options.length = 0;
        console.log("hi");

        if (region == "HKI") {

            hkI.forEach(function (item) {
                var option = document.createElement("option");
                option.text = item;
                option.value = item;
                option.id = item;
                mallElem.add(option);

                if (region == item) {
                    document.getElementById(item).selected = "selected";
                }
            });

            mallElem.disabled = false;



        } else if (region == "KWL") {

            kwl.forEach(function (item) {
                var option = document.createElement("option");
                option.text = item;
                option.value = item;
                option.id = item;
                mallElem.add(option);

                if (region == item) {
                    document.getElementById(item).selected = "selected";
                }

            });

            mallElem.disabled = false;

        } else if (region = "NT") {

            nt.forEach(function (item) {
                var option = document.createElement("option");
                option.text = item;
                option.value = item;
                option.id = item;
                mallElem.add(option);

                if (region == item) {
                    document.getElementById(item).selected = "selected";
                }

            });

            mallElem.disabled = false;



        } else {
            mallElem.disabled = true;
        }
    }

</script>


<script>


    alert("Page is loaded");


    //document.querySelector('#4').selected = "selected";

    if ("<%= coupon.region %>" == "KWL") {
        document.getElementById("KWL").selected = "selected";
        regionSelected("KWL");
    } else if ("<%= coupon.region %>" == "HKI") {
        document.getElementById("HKI").selected = "selected";
        regionSelected("HKI");
    } else if ("<%= coupon.region %>" == "NT") {
        document.getElementById("NT").selected = "selected";
        regionSelected("NT");
    } else {
        document.getElementById("non").selected = "selected";
        regionSelected("");
    }




</script>